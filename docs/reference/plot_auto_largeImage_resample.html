<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Optimized largeImage resampling — plot_auto_largeImage_resample • Giotto Suite</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Optimized largeImage resampling — plot_auto_largeImage_resample"><meta property="og:description" content="Downsample largeImage for plotting. Uses spatSample
to load only a portion of the original image, speeding up plotting and lowering memory
footprint.
Default behavior of spatSample is to crop if only a smaller ROI is needed for plotting
followed by the sampling process in order to reduce wasted sampling by focusing the
sample space. For very large ROIs, this crop can be time intensive and require
writing to disk.
This function examines the ROI dimensions as defined through the limits of the spatial
locations to be plotted, and decides between the following two methods in order to
avoid this issue:
Method A. First crop original image and then sample n values where
  n = 500,000 to generate final image
Method B. First oversample n values and then crop, where n = 500,000
  scaled by a value &amp;gt;1. Scaling factor increases the smaller the ROI is and
  is defined by: original dimensions/crop dimensions where the larger ratio between
  x and y dims is chosen. Scale factor is capped by max_resample_scale
Control points for this function are set by max_crop which decides the max
ROI area after which switchover to method B happens in order to avoid laborious crops
and max_resample_scale which determines the maximum scale factor for number
of values to sample. Both values can be adjusted depending on system resources.
Additionally, flex_resample determines if this switching behavior happens.
When set to FALSE, only method A is used."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-BCXT5392QC"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BCXT5392QC');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Giotto Suite</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Start
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/getting_started.html#installation">Installation</a>
    </li>
    <li>
      <a href="../articles/getting_started.html#getting-started">Getting Started</a>
    </li>
    <li>
      <a href="../articles/getting_started.html#analyses">Analyses</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Datasets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/datasets_overview.html#array-based-datasets-1">Array based</a>
    </li>
    <li>
      <a href="../articles/datasets_overview.html#single-cell-1">Single-cell</a>
    </li>
    <li>
      <a href="../articles/datasets_overview.html#subcellular-datasets-1">Subcellular</a>
    </li>
    <li>
      <a href="../articles/datasets_overview.html#protein-multiplexing-1">Protein multiplexing</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/contribute.html">Contribute</a>
</li>
<li>
  <a href="../articles/giotto_news.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    FAQ
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/faqs.html">Frequently Asked Questions</a>
    </li>
    <li>
      <a href="../articles/github_issues.html">GitHub Issues Guidelines</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Try Giotto
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Docker</li>
    <li class="dropdown-header">Binder</li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/drieslab/Giotto/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Optimized largeImage resampling</h1>
    <small class="dont-index">Source: <a href="https://github.com/drieslab/Giotto/blob/HEAD/R/spatial_visuals.R" class="external-link"><code>R/spatial_visuals.R</code></a></small>
    <div class="hidden name"><code>plot_auto_largeImage_resample.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Downsample <code>largeImage</code> for plotting. Uses <code><a href="https://rdrr.io/pkg/terra/man/sample.html" class="external-link">spatSample</a></code>
to load only a portion of the original image, speeding up plotting and lowering memory
footprint.</p>
<p>Default behavior of <code>spatSample</code> is to crop if only a smaller ROI is needed for plotting
followed by the sampling process in order to reduce wasted sampling by focusing the
sample space. For very large ROIs, this crop can be time intensive and require
writing to disk.</p>
<p>This function examines the ROI dimensions as defined through the limits of the spatial
locations to be plotted, and decides between the following two methods in order to
avoid this issue:</p><ul><li><p><strong>Method A.</strong> First crop original image and then sample n values where
  n = 500,000 to generate final image</p></li>
<li><p><strong>Method B.</strong> First oversample n values and then crop, where n = 500,000
  scaled by a value &gt;1. Scaling factor increases the smaller the ROI is and
  is defined by: original dimensions/crop dimensions where the larger ratio between
  x and y dims is chosen. Scale factor is capped by <code>max_resample_scale</code></p></li>
</ul><p>Control points for this function are set by <code>max_crop</code> which decides the max
ROI area after which switchover to method B happens in order to avoid laborious crops
and <code>max_resample_scale</code> which determines the maximum scale factor for number
of values to sample. Both values can be adjusted depending on system resources.
Additionally, <code>flex_resample</code> determines if this switching behavior happens.
When set to <code>FALSE</code>, only method A is used.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_auto_largeImage_resample</span><span class="op">(</span></span>
<span>  <span class="va">gobject</span>,</span>
<span>  giottoLargeImage <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  largeImage_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spat_unit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spat_loc_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  polygon_feat_type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  include_image_in_border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  flex_resample <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  max_crop <span class="op">=</span> <span class="fl">1e+08</span>,</span>
<span>  max_resample_scale <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>gobject</dt>
<dd><p><code>gobject</code> containing <code>largeImage</code> object</p></dd>


<dt>giottoLargeImage</dt>
<dd><p><code>largeImage</code> object to resample if not provided through
<code>gobject</code> and <code>largeImage_name</code></p></dd>


<dt>largeImage_name</dt>
<dd><p>name of <code>largeImage</code> in <code>gobject</code></p></dd>


<dt>spat_unit</dt>
<dd><p>spatial unit</p></dd>


<dt>spat_loc_name</dt>
<dd><p>name of spatial locations to plot</p></dd>


<dt>polygon_feat_type</dt>
<dd><p>name of polygon/spatial_info to plot</p></dd>


<dt>include_image_in_border</dt>
<dd><p>[boolean] expand the extent sampled to also show image in
border regions not included in spatlocs. This prevents images in plots from
being sharply cut off around the furthest spatial locations. (default is <code>TRUE</code>)</p></dd>


<dt>flex_resample</dt>
<dd><p>[boolean] Whether to allow automatic selection of sampling
workflow as defined in details sections. (default is <code>TRUE</code>)</p></dd>


<dt>max_crop</dt>
<dd><p>maximum crop size allowed for <strong>method A</strong> before switching to
<strong>method B</strong> (see description)</p></dd>


<dt>max_resample_scale</dt>
<dd><p>maximum cells allowed to resample to compensate for
decreased resolution when cropping after sampling</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a <code>giottoLargeImage</code> cropped and resampled properly for plotting</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/terra/man/sample.html" class="external-link">spatSample</a></code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://www.drieslab.com/" class="external-link">Ruben Dries</a>, Jiaji George Chen, Natalie Del Rossi, Emma Kelley, Junxiang Xu, Guo-Cheng Yuan, Matthew O’Brien, Joselyn Chávez.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

